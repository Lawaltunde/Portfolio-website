{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
<div class="admin-container">
    <h2>Admin Dashboard</h2>
    
    <h3>Add New Project</h3>
    <form method="POST" action="{{ url_for('routes.dashboard') }}" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
            <label for="title">Title</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description" required></textarea>
        </div>
        <div class="form-group">
            <label for="github_url">GitHub URL</label>
            <input type="text" id="github_url" name="github_url">
        </div>
        <div class="form-group">
            <label for="image_url">Image URL (optional if you upload a file)</label>
            <input type="text" id="image_url" name="image_url" placeholder="e.g. images/portfolio.jpeg or full URL">
        </div>
        <div class="form-group">
            <label for="image_file">Image Upload (optional)</label>
            <input type="file" id="image_file" name="image_file" accept="image/*">
        </div>
        <div class="form-group">
            <label for="tech_stack">Tech Stack (comma-separated)</label>
            <input type="text" id="tech_stack" name="tech_stack">
        </div>
        <button type="submit" class="btn">Add Project</button>
    </form>

    <hr>

    <h3>Your Projects</h3>
    <div class="projects-list">
        {% for project in projects %}
            <div class="project-item">
                <h4>{{ project.title }}</h4>
                <p>{{ project.description }}</p>
                <p><strong>Tech Stack:</strong> {{ project.tech_stack }}</p>
                <a href="{{ project.github_url }}" target="_blank">GitHub</a>
                <div class="project-actions">
                    <a href="{{ url_for('routes.edit_project', project_id=project.id) }}" class="btn">Edit</a>
                    <form method="POST" action="{{ url_for('routes.delete_project', project_id=project.id) }}" style="display:inline;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </div>
            </div>
        {% else %}
            <p>You haven't added any projects yet.</p>
        {% endfor %}
    </div>
</div>
<div class="admin-container" style="margin-top:2rem;">
    <h2>Blog Manager</h2>
    <h3>Create Blog Post</h3>
    <form method="POST" action="{{ url_for('routes.create_blog') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="form-group">
            <label for="blog_title">Title</label>
            <input type="text" id="blog_title" name="title" required>
        </div>
        <div class="form-group">
            <label for="blog_content">Content</label>
            <textarea id="blog_content" name="content" rows="8" required></textarea>
        </div>
        <button type="submit" class="btn">Publish</button>
    </form>

    <hr>

    <h3>Your Blog Posts</h3>
    <div class="posts-list">
        {% for post in posts %}
            <div class="post-item">
                <h4><a href="{{ url_for('routes.blog_detail', post_id=post.id) }}" target="_blank">{{ post.title }}</a></h4>
                <p class="meta">{{ post.created_at }}</p>
                <form method="POST" action="{{ url_for('routes.delete_blog', post_id=post.id) }}" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        {% else %}
            <p>You haven't created any posts yet.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}